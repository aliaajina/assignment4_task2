---
title: "Assignment 4 Task 2"
author: "Alia Ajina"
date: "11/3/2021"
output: html_document
---

## Overview

## Setup


```{r setup, include=TRUE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(kableExtra)
```

## Read in Bonanza Creek Hares data

```{r}
bonanza <- read_csv(here("data", "bonanza_hares.csv"))
```

## Data Wrangling

```{r}
juvenile_hare <- bonanza %>% 
filter(age == "j") %>% 
mutate(date = mdy(date)) %>% 
mutate(year = year(date)) %>% 
group_by(year) %>% 
summarise(hare_count = n())
  
```

## Summary Statistics

Summarize the data and create a table of summary statistics 

```{r}
# Create table of summary stats
juvenile_hare_summary <- juvenile_hare %>% 
  summarise(mean_count = mean(hare_count, na.rm = TRUE), 
            median_count = median(hare_count, na.rm = TRUE), 
            sd_count = sd(hare_count, na.rm = TRUE), 
            max_count = max(hare_count, na.rm = TRUE),
            min_count = min(hare_count, na.rm = TRUE))
```

## Data Visualization

```{r}
# Create column graph
ggplot(data = juvenile_hare, 
       aes(x = year, y = hare_count)) +
# Change aesthetics accordingly
  geom_col(color = "light blue", fill = "light blue") +
  theme_minimal() +   
  scale_x_continuous(breaks = 1999:2012) +
  scale_y_continuous(breaks = c(0, 20, 40, 60, 80, 100, 120, 140)) +
  labs( x = "Year",
        y = "Number of Juvenile Hare Traps",
        caption = expression(paste(bold("Figure 1: "), "Total number of juvenile snowshoe hare trappings per year from 1999 to 2012 at Bonanza Creek Long Term Ecological Research site"))) +
# Adjust positioning
  theme(axis.text.x = element_text(size = 6, hjust = 0.5),
        axis.text.y = element_text(size = 6),
        axis.title.x = element_text(hjust = 0.5, 
                                    vjust = 0.5),
        plot.caption = element_text(hjust = .9), 
        legend.position = "none")
```

Then, in 3 - 4 sentences below your figure, describe major takeaways from your graph about total snowshoe hare trappings at the site. You might consider:

What were the minimum and maximum counts of juvenile hare trappings?
Mean or median annual number of juvenile hares trapped?
General/notable trends?
These are absolute counts, but this count is also impacted by effort (e.g. the number of days and number of traps in the study each year). What would you suggest be done moving forward (you are not expected to actually do this) to standardize the juvenile hare population in future analyses?


### Annual Juvenile Hare Trap Counts Outcomes:



## Juvenile Hare Weights

## Data Wrangling

```{r}
hare_weights_sex <- bonanza %>% 
  filter(age == "j") %>% 
  mutate(full_grid = case_when(
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonbs" ~ "Bonanza Black Spruce")) %>% 
  mutate(full_sex = case_when(
    sex == "f" ~ "female",
    sex == "m" ~ "male",
    TRUE ~ "NA")) %>% 
  group_by(weight) %>% 
  summarize(full_sex, full_grid)
```

## Data Visualization

```{r}
ggplot(data = hare_weights_sex, aes(x = full_sex, y = weight)) +
  geom_col(aes(color = full_sex, 
                     fill = full_sex), bins = 10) +
  scale_fill_manual(values = c("pink", "blue", "black")) +
  scale_color_manual(values = c("pink", "blue", "black")) +
  facet_wrap(~ full_grid) +
  theme_grey() +
  labs(x = "Sex",
       y = "Weight (g)",
       caption = expression(paste(bold("Figure 2: "), "Distribution of juvenile hare weights in grams by sex and site at Bonanza Creek Long Term Ecological Research site. "))) +
  theme(axis.text.x = element_text(size = 6, hjust = 0.5),
        axis.text.y = element_text(size = 6),
        axis.title.x = element_text(hjust = 0.5, 
                                    vjust = 0.5),
        plot.caption = element_text(hjust = .8), 
        legend.position = "none")
```

